<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quotation</title>
  <style>
    body { font-family: Arial, sans-serif; margin:40px; }
    .header { display:flex; justify-content:space-between; align-items:flex-start; }
    .logo img { width:120px; }
    .company-info { font-size:14px; margin-top:5px; }
    .center { text-align: center; font-size:22px; font-weight:bold; margin:20px 0; }
    table { width:100%; border-collapse: collapse; margin-top:20px; }
    th, td { border:1px solid #000; padding:8px; text-align:center; }
    th { background:#f2f2f2; }
    input { width: 100%; border: none; text-align:center; font-size:14px; }
    input:focus { outline: 1px dashed #aaa; }
    .no-border { border:none !important; }
    .right { text-align:right; }
    #downloadBtn { margin-top:20px; padding:8px 16px; background:#0f4c81; color:#fff; border:none; cursor:pointer; border-radius:5px; }
  </style>
</head>
<body>

  <div class="header">
    <div class="logo">
      <img src="https://www.bing.com/th/id/OIP.5NYKTAl9oxVWNNaCpqFEkAHaHa?w=180&h=211&c=8&rs=1&qlt=90&o=6&pid=3.1&rm=2" alt="Company Logo">
      <div class="company-info">
        <div><input type="text" value="G-Tech Solar"></div>
        <div><input type="text" value="123 Solar Street, Lahore, Pakistan"></div>
        <div><input type="text" value="+92 300 1234567"></div>
        <div><input type="text" value="solar@gtech.com"></div>
      </div>
    </div>
    <div>
      <table>
        <tr>
          <td class="no-border right">Date:</td>
          <td><input type="text" id="date" value="01-10-2025"></td>
        </tr>
        <tr>
          <td class="no-border right">To:</td>
          <td><input type="text" id="client" value="Client Name"></td>
        </tr>
      </table>
    </div>
  </div>

  <div class="center">QUOTATION</div>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>Description</th>
        <th>Qty</th>
        <th>Rate</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="text" value="Solar Panel Model X"></td>
        <td><input type="number" value="1" class="qty"></td>
        <td><input type="number" value="50000" class="rate"></td>
        <td><input type="text" value="50000" class="amount" readonly></td>
      </tr>
    </tbody>
  </table>

  <button onclick="addRow()">+ Add Item</button>

  <table>
    <tr>
      <td class="no-border right"><b>Total:</b></td>
      <td><input type="text" id="grandTotal" value="50000" readonly></td>
    </tr>
  </table>

  <div class="center">
    <button id="downloadBtn">Download PDF</button>
  </div>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    function recalc(){
      let rows = document.querySelectorAll("#itemsTable tbody tr");
      let total = 0;
      rows.forEach(r=>{
        let qty = r.querySelector(".qty").value;
        let rate = r.querySelector(".rate").value;
        let amt = (qty*rate);
        r.querySelector(".amount").value = amt.toFixed(2);
        total += amt;
      });
      document.getElementById("grandTotal").value = total.toFixed(2);
    }
    document.addEventListener("input", e=>{
      if(e.target.classList.contains("qty") || e.target.classList.contains("rate")){
        recalc();
      }
    });
    function addRow(){
      let tbody = document.querySelector("#itemsTable tbody");
      let tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="text" value=""></td>
        <td><input type="number" value="1" class="qty"></td>
        <td><input type="number" value="0" class="rate"></td>
        <td><input type="text" value="0" class="amount" readonly></td>
      `;
      tbody.appendChild(tr);
    }
    document.getElementById("downloadBtn").addEventListener("click", ()=>{
      const { jsPDF } = window.jspdf;
      html2canvas(document.body).then(canvas=>{
        let pdf = new jsPDF("p","pt","a4");
        let img = canvas.toDataURL("image/png");
        let w = pdf.internal.pageSize.getWidth();
        let h = canvas.height * w / canvas.width;
        pdf.addImage(img,"PNG",0,0,w,h);
        pdf.save("Quotation.pdf");
      });
    });
    recalc();
  </script>

</body>
</html>

