<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quotation</title>
  <style>
    body { font-family: Arial, sans-serif; margin:40px; }
    .header { display:flex; justify-content:space-between; align-items:flex-start; }
    .logo img { width:120px; }
    .company-info { font-size:14px; margin-top:5px; }
    .center { text-align: center; font-size:22px; font-weight:bold; margin:20px 0; }
    table { width:100%; border-collapse: collapse; margin-top:20px; }
    th, td { border:1px solid #000; padding:8px; text-align:center; vertical-align:top; }
    th { background:#f2f2f2; }
    input, textarea { 
      width: 100%; 
      border: none; 
      font-size:14px; 
      text-align:center; 
    }
    input:focus, textarea:focus { outline: 1px dashed #aaa; }

    /* Textarea auto-resize style */
    textarea {
      resize: none;          
      overflow: hidden;      
      line-height: 1.2em;
      min-height: 40px;
    }

    .no-border { border:none !important; }
    .right { text-align:right; }
    #downloadBtn { margin-top:20px; padding:8px 16px; background:#0f4c81; color:#fff; border:none; cursor:pointer; border-radius:5px; }
  </style>
</head>
<body>
<h1>G-Tech Solar</h1>
  <div class="header">
      <div class="company-info">
        <div><input type="text" value="123 Solar Street, Lahore, Pakistan"></div>
        <div><input type="text" value="+92 300 1234567"></div>
        <div><input type="text" value="solar@gtech.com"></div>
      </div>
    </div>
    <div>
      <table>
        <tr>
          <td class="no-border right">Date:</td>
          <td><input type="text" id="date" value="01-10-2025"></td>
        </tr>
        <tr>
          <td class="no-border right">To:</td>
          <td><input type="text" id="client" value="Client Name"></td>
        </tr>
      </table>
    </div>

  <div class="center">QUOTATION</div>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>Description</th>
        <th>Qty</th>
        <th>Rate</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <textarea>Solar Panel Model X - High efficiency and durable design suitable for all weather conditions.</textarea>
        </td>
        <td><input type="number" value="1" class="qty"></td>
        <td><input type="number" value="50000" class="rate"></td>
        <td><input type="text" value="50000" class="amount" readonly></td>
      </tr>
    </tbody>
  </table>

  <button onclick="addRow()">+ Add Item</button>

  <table>
    <tr>
      <td class="no-border right"><b>Total:</b></td>
      <td><input type="text" id="grandTotal" value="50000" readonly></td>
    </tr>
  </table>

  <div class="center">
    <button id="downloadBtn">Download PDF</button>
  </div>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // Auto resize textareas
    function autoResizeTextarea(el) {
      el.style.height = "auto";
      el.style.height = el.scrollHeight + "px";
    }

    document.addEventListener("input", function(e){
      if(e.target.tagName.toLowerCase() === "textarea"){
        autoResizeTextarea(e.target);
      }
      if(e.target.classList.contains("qty") || e.target.classList.contains("rate")){
        recalc();
      }
    });

    window.addEventListener("load", ()=>{
      document.querySelectorAll("textarea").forEach(autoResizeTextarea);
      recalc();
    });

    // Recalculate totals
    function recalc(){
      let rows = document.querySelectorAll("#itemsTable tbody tr");
      let total = 0;
      rows.forEach(r=>{
        let qty = parseFloat(r.querySelector(".qty").value) || 0;
        let rate = parseFloat(r.querySelector(".rate").value) || 0;
        let amt = qty*rate;
        r.querySelector(".amount").value = amt.toFixed(2);
        total += amt;
      });
      document.getElementById("grandTotal").value = total.toFixed(2);
    }

    // Add new row
    function addRow(){
      let tbody = document.querySelector("#itemsTable tbody");
      let tr = document.createElement("tr");
      tr.innerHTML = `
        <td><textarea></textarea></td>
        <td><input type="number" value="1" class="qty"></td>
        <td><input type="number" value="0" class="rate"></td>
        <td><input type="text" value="0" class="amount" readonly></td>
      `;
      tbody.appendChild(tr);
      autoResizeTextarea(tr.querySelector("textarea")); // resize new textarea
    }

    // Download PDF
    document.getElementById("downloadBtn").addEventListener("click", ()=>{
      const { jsPDF } = window.jspdf;
      html2canvas(document.body).then(canvas=>{
        let pdf = new jsPDF("p","pt","a4");
        let img = canvas.toDataURL("image/png");
        let w = pdf.internal.pageSize.getWidth();
        let h = canvas.height * w / canvas.width;
        pdf.addImage(img,"PNG",0,0,w,h);
        pdf.save("Quotation.pdf");
      });
    });
  </script>

</body>
</html>
